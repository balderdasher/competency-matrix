# spring事务传播机制 #

spring事务传播机制共有以下七种：

1. REQUIRED
2. SUPPORTS
3. MANDATORY
4. REQUIRES_NEW
5. NOT_SUPPORTED
6. NEVER
7. NESTED

## REQUIRED ##

默认传播机制，代表当前如果存在事务则使用当前的事务，当前不存在事务则新创建一个事务

例子：领导发不起工资，我自己掏钱买来吃，领导有钱了就跟着领导一起吃

## SUPPORTS ##

当前如果存在事务则使用当前的事务，没有在不使用事务

例子：领导有饭吃，我就有饭吃，领导没饭吃，我就没饭吃

## MANDATORY ##

当前有事务则使用，没有抛异常，调用方必须开启事务

例子：领导必须管饭，不管饭就辞职（抛异常）

## REQUIRES_NEW ##

创建一个新的事务并在新事务中执行，如果原来有事务存在则挂起原来的事务，如果当前没有事务，则与`REQUIRED`相同

例子：领导有饭吃，我不吃领导的自己买来吃，领导食物中毒死了不会影响到我，我自己中不中毒是我自己的事

## NOT_SUPPORTED ##

无事务执行，如果当前存在事务则挂起当前的事务，不管调用方有没有事务，自己都不开启事务

例子：领导管饭，但我偏不吃，也不自己买来吃，挂起当前事务就相当于自己执行之后当前事务再继续执行，所以如果自己没吃饭饿死了之后，领导就要赔钱了

## NEVER ##

拒绝在事务中执行，如果当前存在事务则抛异常，意味着调用方也不能有事务，跟`NOT_SUPPORTED`的区别在于`NOT_SUPPORTED`不需要事务但是有调用方存在事务时不抛异常，但是`NEVER`抛异常

例子：我自己不想吃饭的时候领导也不能给我饭吃，否则辞职（抛异常）

## NESTED ##

嵌套事务，如果当前有事务，则开启一个子事务（嵌套事务），嵌套事务独立提交或回滚，如果当前没有事务，则跟`REQUIRED`相同，子方法抛异常时可以在主方法中try catch利用savepoint进行事务控制，主方法的其他事务操作不受影响，即主事务提交或者回滚时，子事务会一起提交或回滚，相反，子事务异常时，主事务可以选择回滚或不回滚（try catch利用savepoint进行子事务控制）

例子：领导决策不对，老板怪罪，领导带着小弟一起背锅，小弟出了错，领导可以推卸责任也可以替小弟出头

## 扩展阅读 ##

- [Spring事务传播机制详解](https://blog.csdn.net/qq_26323323/article/details/81908955)
- [spring 事务的传播机制看这篇就够了](https://segmentfault.com/a/1190000020386113?utm_source=tag-newest "spring 事务的传播机制看这篇就够了")